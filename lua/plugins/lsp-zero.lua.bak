return {
    "VonHeikemen/lsp-zero.nvim",
    branch = "v3.x",
    config = function()
        local lsp_zero = require("lsp-zero")
        lsp_zero.extend_lspconfig()
        local function allow_format(servers)
            return function(client)
                return vim.tbl_contains(servers, client.name)
            end
        end
        require("lspconfig").ruff_lsp.setup({
        })
        require("lspconfig").jedi_language_server.setup({
            init_options = {
                workspace = {
                    extraPaths = { "/home/mironov_a/projectsGit/ci-test-scenarios/" },
                },
            },
        })
        lsp_zero.on_attach(function(client, bufnr)
            lsp_zero.default_keymaps({ buffer = bufnr })
            local opts = { buffer = bufnr }
            if client.supports_method("textDocument/formatting") then
                vim.api.nvim_clear_autocmds({ group = augroup, buffer = bufnr })
                vim.api.nvim_create_autocmd("BufWritePre", {
                    group = augroup,
                    buffer = bufnr,
                    callback = function()
                        vim.lsp.buf.format()
                    end,
                })
            end
            vim.keymap.set("n", "gr", "<cmd>Telescope lsp_references<cr>", { buffer = bufnr })
        end)

    end,
}
